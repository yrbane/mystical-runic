<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemples - Mystical-Runic</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Highlight.js for Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }
        .container {
            max-width: 1200px;
        }
        .sidebar {
            background-color: #2d3748; /* Darker sidebar */
            border-right: 1px solid #4a5568; /* Subtle border */
        }
        .nav-link {
            color: #a0aec0; /* Lighter grey for links */
            display: flex;
            align-items: center;
        }
        .nav-link:hover {
            color: #cbd5e0; /* Even lighter on hover */
            background-color: #4a5568; /* Slightly lighter background on hover */
        }
        .nav-link i {
            margin-right: 0.75rem; /* Space between icon and text */
            width: 1.25rem; /* Fixed width for icons */
            text-align: center;
        }
        h1, h2, h3, h4 {
            color: #63b3ed; /* Blue headings */
            font-weight: 700; /* Bold headings */
        }
        h1 {
            font-size: 2.5rem; /* Larger H1 */
        }
        h2 {
            font-size: 2rem; /* Larger H2 */
        }
        h3 {
            font-size: 1.75rem; /* Larger H3 */
        }
        code {
            background-color: #2d3748;
            color: #f6e05e; /* Yellow for code */
            padding: 0.2em 0.4em;
            border-radius: 0.25rem;
        }
        pre {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1em;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1.5rem; /* More space below code blocks */
        }
        pre code {
            background-color: transparent;
            padding: 0;
        }
        /* Specific styles for highlight.js */
        .hljs {
            background: #2d3748 !important; /* Ensure background matches pre */
            color: #e2e8f0 !important; /* Ensure text color matches pre */
        }
    </style>
</head>
<body class="flex">
    <!-- Sidebar -->
    <aside class="sidebar w-64 p-6 h-screen overflow-y-auto shadow-lg flex-shrink-0">
        <h2 class="text-2xl font-bold mb-6 text-white"><i class="fas fa-hat-wizard"></i> Mystical-Runic</h2>
        <nav>
            <ul>
                <li class="mb-2"><a href="index.html" class="nav-link block py-2 px-4 rounded transition duration-200"><i class="fas fa-home"></i> Accueil</a></li>
                <li class="mb-2"><a href="installation.html" class="nav-link block py-2 px-4 rounded transition duration-200"><i class="fas fa-download"></i> Installation</a></li>
                <li class="mb-2">
                    <h3 class="text-lg font-semibold text-gray-400 mb-2"><i class="fas fa-lightbulb"></i> Concepts Clés</h3>
                    <ul>
                        <li class="mb-1 ml-4"><a href="concepts/overview.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-eye"></i> Vue d'ensemble</a></li>
                        <li class="mb-1 ml-4"><a href="concepts/templating_syntax.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-code"></i> Syntaxe de Templating</a></li>
                        <li class="mb-1 ml-4"><a href="concepts/data_structures.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-database"></i> Structures de Données</a></li>
                        <li class="mb-1 ml-4"><a href="concepts/security_performance.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-shield-alt"></i> Sécurité & Performance</a></li>
                        <li class="mb-1 ml-4"><a href="filters_helpers.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-filter"></i> Filtres & Helpers</a></li>
                    </ul>
                </li>
                <li class="mb-2">
                    <h3 class="text-lg font-semibold text-gray-400 mb-2"><i class="fas fa-book"></i> Référence API</h3>
                    <ul>
                        <li class="mb-1 ml-4"><a href="api/overview.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-sitemap"></i> Vue d'ensemble API</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/template_engine.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-cogs"></i> TemplateEngine</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/template_context.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-box"></i> TemplateContext</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/template_value.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-cube"></i> TemplateValue</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/template_error.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-exclamation-triangle"></i> TemplateError</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/filter_function.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-magic"></i> FilterFunction</a></li>
                        <li class="mb-1 ml-4"><a href="api/functions/helper_function.html" class="nav-link block py-1 px-2 rounded transition duration-200"><i class="fas fa-hat-wizard"></i> HelperFunction</a></li>
                    </ul>
                </li>
                <li class="mb-2"><a href="examples.html" class="nav-link block py-2 px-4 rounded transition duration-200"><i class="fas fa-file-code"></i> Exemples</a></li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-10 overflow-y-auto">
        <div class="container mx-auto">
            <h1 class="text-4xl font-extrabold mb-6">Exemples d'Utilisation de Mystical-Runic</h1>
            <p class="text-lg mb-4 leading-relaxed">Cette section fournit des exemples de code Rust concrets pour vous aider à démarrer rapidement avec la bibliothèque Mystical-Runic et à comprendre comment utiliser ses principales fonctionnalités dans vos propres projets.</p>

            <h2 class="text-3xl font-bold mb-4">1. Rendu de Base (Chaîne de Caractères)</h2>
            <p class="mb-2 leading-relaxed">Le moyen le plus simple de rendre un template est de fournir le contenu du template directement sous forme de chaîne de caractères. C'est idéal pour les templates courts, les tests ou les templates générés dynamiquement.</p>
            <pre><code class="language-rust">
use mystical_runic::{TemplateEngine, TemplateContext, TemplateValue};

fn main() -> Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    // Initialisez le moteur de template. Le chemin "templates" est utilisé pour la résolution
    // des includes/extends, même si nous rendons une chaîne ici.
    let mut engine = TemplateEngine::new("templates"); 
    
    // Créez un nouveau contexte pour vos données. C'est là que vous stockez toutes les variables
    // que votre template utilisera.
    let mut context = TemplateContext::new();

    // Ajoutez des données au contexte. Les clés sont les noms des variables dans le template,
    // et les valeurs sont encapsulées dans TemplateValue.
    context.set("name", TemplateValue::String("World".to_string()));
    context.set("year", TemplateValue::Number(2025));

    // Définissez votre template en ligne sous forme de chaîne de caractères.
    let template_content = "Hello {{name}}! Current year: {{year}}.";
    
    // Rendez le template avec le contexte fourni. La méthode render_string retourne un Result,
    // donc nous utilisons ? pour propager les erreurs.
    let rendered_html = engine.render_string(template_content, &context)?;

    // Affichez le résultat HTML rendu sur la console.
    println!("{{}}", rendered_html);

    Ok(())
}
</code></pre>

            <h2 class="text-3xl font-bold mb-4">2. Rendu à partir d'un Fichier</h2>
            <p class="mb-2 leading-relaxed">Pour des templates plus complexes ou pour une meilleure organisation, vous pouvez charger et rendre un template directement à partir d'un fichier. Le chemin du fichier est résolu par rapport au répertoire de templates spécifié lors de l'initialisation de <code>TemplateEngine</code>.</p>
            <pre><code class="language-rust">
// Supposons que vous avez un fichier 'templates/welcome.html' avec le contenu suivant :
// &lt;h1&gt;Bienvenue, {{ user.name }}!&lt;/h1&gt;

use mystical_runic::{TemplateEngine, TemplateContext, TemplateValue};
use std::path::PathBuf;

fn main() -> Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    // Pour cet exemple, nous allons créer le fichier de template programmatiquement.
    // En production, ce fichier existerait déjà sur votre système de fichiers.
    std::fs::create_dir_all("templates").unwrap();
    std::fs::write("templates/welcome.html", "&lt;h1&gt;Bienvenue, {{ user.name }}!&lt;/h1&gt;").unwrap();

    // Initialisez le moteur avec le répertoire 'templates/' comme base.
    let mut engine = TemplateEngine::new("templates");
    let mut context = TemplateContext::new();

    // Créez un objet TemplateValue pour l'utilisateur et ajoutez-le au contexte.
    let mut user_data = std::collections::HashMap::new();
    user_data.insert("name".to_string(), TemplateValue::String("Alice".to_string()));
    context.set("user", TemplateValue::Object(user_data));

    // Rendez le template à partir du fichier 'welcome.html'.
    let rendered_html = engine.render_file("welcome.html", &context)?;

    println!("{{}}", rendered_html); // Affiche: &lt;h1&gt;Bienvenue, Alice!&lt;/h1&gt;

    // Nettoyage (supprime le fichier et le répertoire créés pour l'exemple)
    std::fs::remove_file("templates/welcome.html").unwrap();
    std::fs::remove_dir("templates").unwrap();

    Ok(())
}
</code></pre>

            <h2 class="text-3xl font-bold mb-4">3. Utilisation de Filtres Personnalisés</h2>
            <p class="mb-2 leading-relaxed">Mystical-Runic vous permet de définir et d'enregistrer vos propres filtres pour transformer les données directement dans vos templates. C'est un excellent moyen d'ajouter des logiques de formatage ou de manipulation de données réutilisables.</p>
            <pre><code class="language-rust">
use mystical_runic::{TemplateEngine, TemplateContext, TemplateValue, TemplateResult, FilterFunction};

// Définition d'un filtre personnalisé qui inverse une chaîne de caractères.
fn reverse_string_filter(value: &TemplateValue, _args: Vec&lt;TemplateValue&gt;) -> TemplateResult&lt;TemplateValue&gt; {
    if let TemplateValue::String(s) = value {
        Ok(TemplateValue::String(s.chars().rev().collect()))
    } else {
        // Retourne une erreur si le filtre est appliqué à un type non supporté (non-chaîne).
        Err(mystical_runic::TemplateError::RuntimeError("Filtre 'reverse' attend une chaîne.".to_string()))
    }
}

fn main() -> TemplateResult&lt;()&gt; {
    let mut engine = TemplateEngine::new("templates");
    
    // Enregistrez votre filtre personnalisé avec un nom (ici, "reverse").
    engine.register_filter("reverse", Box::new(reverse_string_filter));

    let mut context = TemplateContext::new();
    context.set("word", TemplateValue::String("Rust".to_string()));

    // Utilisez le filtre dans votre template avec la syntaxe | nom_du_filtre
    let template = "Le mot inversé est : {{ word | reverse }}";
    let rendered = engine.render_string(template, &context)?;

    println!("{{}}", rendered); // Affiche: Le mot inversé est : tsuR

    Ok(())
}
</code></pre>

            <h2 class="text-3xl font-bold mb-4">4. Utilisation de Helpers Personnalisés</h2>
            <p class="mb-2 leading-relaxed">Les helpers sont plus puissants que les filtres et peuvent exécuter des logiques complexes, interagir avec le contexte ou même le moteur de template. Ils sont parfaits pour des macros réutilisables ou des fonctions utilitaires complexes.</p>
            <pre><code class="language-rust">
use mystical_runic::{TemplateEngine, TemplateContext, TemplateValue, TemplateResult, HelperFunction};

// Définition d'un helper personnalisé qui calcule la somme de ses arguments numériques.
fn custom_sum_helper(
    _context: &TemplateContext, // Le contexte actuel (non utilisé ici, mais disponible)
    _engine: &mut TemplateEngine, // Le moteur de template (non utilisé ici, mais disponible)
    _name: &str, // Le nom du helper (non utilisé ici)
    args: Vec&lt;TemplateValue&gt;, // Les arguments passés au helper depuis le template
) -> TemplateResult&lt;TemplateValue&gt; {
    let mut sum = 0i64;
    for arg in args {
        if let TemplateValue::Number(n) = arg {
            sum += n;
        } else {
            return Err(mystical_runic::TemplateError::RuntimeError("Helper 'sum' attend des nombres comme arguments.".to_string()));
        }
    }
    Ok(TemplateValue::Number(sum))
}

fn main() -> TemplateResult&lt;()&gt; {
    let mut engine = TemplateEngine::new("templates");
    
    // Enregistrez votre helper personnalisé avec un nom (ici, "sum").
    engine.register_helper("sum", Box::new(custom_sum_helper));

    let mut context = TemplateContext::new();

    // Utilisez le helper dans votre template avec la syntaxe {{ nom_du_helper arg1 arg2 ...}}
    let template = "La somme est : {{sum 10 20 30}}";
    let rendered = engine.render_string(template, &context)?;

    println!("{{}}", rendered); // Affiche: La somme est : 60

    Ok(())
}
</code></pre>
        </div>
    </main>
    <!-- Highlight.js Initialization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>
        hljs.highlightAll();
    </script>
</body>
</html>